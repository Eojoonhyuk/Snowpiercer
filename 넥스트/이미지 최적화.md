# 이미지 최적화
## Next/image에서 제공하는 기능
- 장치의 크기에 맞춘 적절한 이미지 사이즈와 최신 이미지 포맷 지원
- Web Vitals의 CLS 발생을 방지
- 레이지 로드를 기본적으로 사용하고 있기 때문에, 뷰포트에 노출됐을 때 이미지 로드. 선택적으로 블러링 처리한 이미지를 먼저 노출하는 기능
- 이미지 리사이징. 외부 이미지도 리사이징 가능
  
## 이미지 최적화 시점과 이미지 재사용
Next는 요청이 들어왔을 떄, dist 폴더 밑에 cache/images 폴더에 최적화한 이미지를 동적으로 만들고, 이후에 동일한 요청에 대해서는 이미 만들어 놓은 최적화한 이미지를 캐시로서 재사용합니다.

## 모든 이미지를 최적화 하는가?
동적으로 최적화를 해야 하므로 이미지 최적화가 필요 없는 SVG나 vector이미지, 그리고 GIF와 같은 상대적으로 복잡하고 최적화에 오래 걸리는 애니메이션 이미지의 경우에는 코드 레벨에서 최적화를 진행하지 않고 바로 응답으로 내려준다.

## sharp vs squoosh
Next 운영 환경에서 sharp 라이브러리 사용을 권장하는 이유
- 다양한 크기의 JPEG, PNG, WebP, GIF, AVIF와 같은 이미지들을 더 작은 크기로, 그리고 웹에 진화적으로 변환해 주는 매우 빠른 속도의 모듈

## 요약
- Next는 모던 브라우저에서 고려해야 할 대부분의 최적화를 자체적으로 지원하고 있어 개발자의 부담을 덜어줄 수 있다.
- 이미지 최적화는 빌드 타임이 아닌 런타임에 요청이 들어왔을 때 최적화를 진행한다. 그렇기에 최초 1회 요청은 응답이 느릴 수 있다.
- 브라우저의 요청에 맞춰서 최적화한 이미지를 응답으로 내려주기에 브라우저 호환성에 대한 고민을 덜 할 수 있다.

## 참고 자료
- https://oliveyoung.tech/blog/2023-06-09/nextjs-image-optimization/
- https://nextjs.org/docs/app/building-your-application/optimizing/images
